# ë°±ì—”ë“œ ê°œë°œ ê°€ì´ë“œ

**í”„ë¡œì íŠ¸ëª…:** SimpleBlog
**ì‘ì„±ì¼:** 2025-10-17
**ì‘ì„±ì:** ê°œë°œíŒ€
**ë²„ì „:** 1.0

---

## ğŸ“Œ ì´ ë‹¨ê³„ì˜ ëª©ì 

### ì™œ ë°±ì—”ë“œ ê°œë°œ ê°€ì´ë“œë¥¼ ì‘ì„±í•˜ë‚˜ìš”?

**"ì‹¤ì œë¡œ ì–´ë–»ê²Œ ì½”ë”©í•˜ëŠ”ê°€?"**

PMì€ ì½”ë“œë¥¼ ì§ì ‘ ì‘ì„±í•˜ì§€ ì•Šì§€ë§Œ, **ê°œë°œ ê³¼ì •ì„ ì´í•´**í•´ì•¼ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ê°œë°œ ì¼ì • ì‚°ì • (API 1ê°œë‹¹ 2ì‹œê°„)
- ê°œë°œìì™€ ê¸°ìˆ  íšŒì˜
- ê³ ê°ì—ê²Œ ì§„í–‰ ìƒí™© ì„¤ëª…

### PMì´ ê¼­ ì•Œì•„ì•¼ í•  ê²ƒ

#### 1. 3ê³„ì¸µ ì•„í‚¤í…ì²˜ (ê°€ì¥ ì¤‘ìš”!)

```
ì‚¬ìš©ì â†’ Controller â†’ Service â†’ Repository â†’ Database
         (ì ‘ìˆ˜)     (ì²˜ë¦¬)     (ì €ì¥)

ì‹¤ë¬´ ë¹„ìœ :
Controller = ê³ ê°ì„¼í„° ì§ì› (ì „í™” ë°›ê³ , ë‹´ë‹¹ìì—ê²Œ ì—°ê²°)
Service    = ì‹¤ë¬´ ë‹´ë‹¹ì (ì—…ë¬´ ì²˜ë¦¬, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
Repository = ì°½ê³  ë‹´ë‹¹ì (DBì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°/ì €ì¥)
```

**ì™œ 3ê³„ì¸µìœ¼ë¡œ ë‚˜ëˆ„ë‚˜ìš”?**
```
âŒ ë‚˜ìœ ì˜ˆ: Controllerì—ì„œ DB ì§ì ‘ ì ‘ê·¼
â†’ ë‚˜ì¤‘ì— DB ë³€ê²½í•˜ë©´ ëª¨ë“  ì½”ë“œ ìˆ˜ì •

âœ… ì¢‹ì€ ì˜ˆ: 3ê³„ì¸µ ë¶„ë¦¬
â†’ DBë§Œ ë°”ê¾¸ë©´ Repositoryë§Œ ìˆ˜ì •
```

---

#### 2. ê°œë°œ ìˆœì„œ (ì¤‘ìš”!)

```
1. Entity ì‘ì„± (DB í…Œì´ë¸” â†” Java í´ë˜ìŠ¤)
2. Repository ì‘ì„± (DB ì ‘ê·¼ ì¸í„°í˜ì´ìŠ¤)
3. DTO ì‘ì„± (ìš”ì²­/ì‘ë‹µ ë°ì´í„° êµ¬ì¡°)
4. Service ì‘ì„± (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
5. Controller ì‘ì„± (API ì—”ë“œí¬ì¸íŠ¸)
6. í…ŒìŠ¤íŠ¸ ì‘ì„± (ì •ìƒ ë™ì‘ í™•ì¸)
```

**ì™œ ì´ ìˆœì„œì¸ê°€ìš”?**
```
ì•„ë˜ë¶€í„° ìœ„ë¡œ (Bottom-Up):
Database â†’ Entity â†’ Repository â†’ Service â†’ Controller

ë§ˆì¹˜ ê±´ë¬¼ ì§“ë“¯ì´:
1ì¸µ(DB) â†’ 2ì¸µ(Repository) â†’ 3ì¸µ(Service) â†’ ì˜¥ìƒ(Controller)
```

---

#### 3. ì‹¤ë¬´ Tip

â­ **ì½”ë“œ ë¦¬ë·° í•„ìˆ˜**
```
ê°œë°œì í˜¼ì ì½”ë”© â†’ PR (Pull Request) â†’ íŒ€ì› ë¦¬ë·° â†’ ë³‘í•©

ì½”ë“œ ë¦¬ë·°ì—ì„œ í™•ì¸í•  ê²ƒ:
- 3ê³„ì¸µ ì•„í‚¤í…ì²˜ ì¤€ìˆ˜í–ˆëŠ”ì§€
- ì˜ˆì™¸ ì²˜ë¦¬ í–ˆëŠ”ì§€
- í…ŒìŠ¤íŠ¸ ì‘ì„±í–ˆëŠ”ì§€
- ì½”ë“œ ì¤‘ë³µ ì—†ëŠ”ì§€
```

â­ **ì‘ì€ ë‹¨ìœ„ë¡œ commit**
```
âŒ ë‚˜ìœ ì˜ˆ: "ê¸°ëŠ¥ ì™„ì„±" (1,000ì¤„ ë³€ê²½)
âœ… ì¢‹ì€ ì˜ˆ: "feat: Post Entity ì‘ì„±" (50ì¤„ ë³€ê²½)

ì‘ê²Œ ìª¼ê°œì•¼ ë‚˜ì¤‘ì— ë¬¸ì œ ìƒê²¼ì„ ë•Œ ë¡¤ë°± ì‰¬ì›€
```

â­ **ì£¼ì„ì€ "ì™œ"ë¥¼ ì„¤ëª…**
```
âŒ ë‚˜ìœ ì˜ˆ:
// ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ
public List<Post> findAll() { ... }
â†’ ì½”ë“œ ë³´ë©´ ì•Œ ìˆ˜ ìˆìŒ

âœ… ì¢‹ì€ ì˜ˆ:
// ìµœì‹ ìˆœ ì •ë ¬ì„ ìœ„í•´ created_at DESC ì¸ë±ìŠ¤ í™œìš©
public List<Post> findAllOrderByCreatedAtDesc() { ... }
â†’ "ì™œ ì´ë ‡ê²Œ í–ˆëŠ”ì§€" ì„¤ëª…
```

---

#### 4. ì œì•ˆì„œ/PTì—ì„œ ì„¤ëª…í•˜ëŠ” ë²•

**ì•„í‚¤í…ì²˜ ì„¤ëª… ì˜ˆì‹œ:**

> "SimpleBlogëŠ” **3ê³„ì¸µ ì•„í‚¤í…ì²˜**ë¥¼ ì ìš©í–ˆìŠµë‹ˆë‹¤.
>
> **Controller ê³„ì¸µ (API):**
> - REST API ì—”ë“œí¬ì¸íŠ¸ 5ê°œ
> - JSON ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
> - ì…ë ¥ê°’ ìœ íš¨ì„± ê²€ì¦
>
> **Service ê³„ì¸µ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§):**
> - ê²Œì‹œê¸€ CRUD ë¡œì§
> - íŠ¸ëœì­ì…˜ ê´€ë¦¬
> - ì˜ˆì™¸ ì²˜ë¦¬
>
> **Repository ê³„ì¸µ (ë°ì´í„° ì ‘ê·¼):**
> - Spring Data JPA ì‚¬ìš©
> - SQL ìë™ ìƒì„± (80% ì´ìƒ)
> - ë³µì¡í•œ ì¿¼ë¦¬ëŠ” JPQL ì§ì ‘ ì‘ì„±
>
> **ì¥ì :**
> - ê³„ì¸µë³„ ë…ë¦½ì  í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
> - ìœ ì§€ë³´ìˆ˜ ìš©ì´ (ë³€ê²½ ì˜í–¥ë„ ìµœì†Œí™”)
> - í‘œì¤€ ì•„í‚¤í…ì²˜ë¡œ ê°œë°œì ì´í•´ ì‰¬ì›€"

---

#### 5. ê³µë¬´ì›ì´ ìì£¼ í•˜ëŠ” ì§ˆë¬¸

**Q1: "ì½”ë“œ ëª‡ ì¤„ì´ë‚˜ ë˜ë‚˜ìš”?"**
A: "SimpleBlog ê¸°ì¤€ ì•½ 500~700ì¤„ì…ë‹ˆë‹¤.

   - Entity: 50ì¤„
   - Repository: 20ì¤„ (ì¸í„°í˜ì´ìŠ¤ë§Œ)
   - Service: 150ì¤„
   - Controller: 100ì¤„
   - DTO: 80ì¤„
   - í…ŒìŠ¤íŠ¸: 200ì¤„

   ì°¸ê³ ë¡œ RealWorld ê°™ì€ ì¤‘í˜• í”„ë¡œì íŠ¸ëŠ” 5,000ì¤„ ì •ë„ì…ë‹ˆë‹¤."

**Q2: "ê°œë°œ ê¸°ê°„ì€ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ë‚˜ìš”?"**
A: "SimpleBlog ê¸°ì¤€ ë°±ì—”ë“œ ê°œë°œì 1ëª… ê¸°ì¤€:

   - í™˜ê²½ ì„¤ì •: 0.5ì¼
   - Entity + Repository: 0.5ì¼
   - Service ê°œë°œ: 1ì¼
   - Controller ê°œë°œ: 1ì¼
   - í…ŒìŠ¤íŠ¸ ì‘ì„±: 1ì¼
   - ë²„ê·¸ ìˆ˜ì •: 0.5ì¼
   **ì´: 4.5ì¼ (ì•½ 1ì£¼ì¼)**

   ì—¬ìœ ë¥¼ ë‘ê³  2ì£¼ ì‚°ì • ê¶Œì¥í•©ë‹ˆë‹¤."

**Q3: "JavaëŠ” ì½”ë“œê°€ ë§ë‹¤ê³  ë“¤ì—ˆëŠ”ë°?"**
A: "ì˜ˆì „ JavaëŠ” ê·¸ë¬ì§€ë§Œ, ìµœì‹  Java + Lombokì€ ê°„ê²°í•©ë‹ˆë‹¤.

   **ì˜ˆì „ Java (100ì¤„):**
   ```java
   public class Post {
       private Long id;
       public Long getId() { return id; }
       public void setId(Long id) { this.id = id; }
       // ... ë°˜ë³µ
   }
   ```

   **í˜„ëŒ€ Java + Lombok (10ì¤„):**
   ```java
   @Data
   @Entity
   public class Post {
       @Id @GeneratedValue
       private Long id;
       private String title;
   }
   ```

   â†’ 10ë°° ê°„ê²°!"

**Q4: "ì—ëŸ¬ê°€ ë‚˜ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?"**
A: "ë‹¤ì¸µ ë°©ì–´ êµ¬ì¡°ë¥¼ ë§Œë“­ë‹ˆë‹¤:

   1ì°¨: ì…ë ¥ê°’ ê²€ì¦ (Controller)
   2ì°¨: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦ (Service)
   3ì°¨: ì˜ˆì™¸ ì²˜ë¦¬ (GlobalExceptionHandler)

   ê³ ê°ì—ê²ŒëŠ” ì¹œì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€:
   ```json
   {
     \"error\": \"POST_NOT_FOUND\",
     \"message\": \"ê²Œì‹œê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ID: 999)\"
   }
   ```"

---

## 1. ê°œë°œ ìˆœì„œ (ì‹¤ìŠµ ë”°ë¼í•˜ê¸°)

### 1.1 Entity ì‘ì„± (DB í…Œì´ë¸” â†” Java í´ë˜ìŠ¤)

**íŒŒì¼ ìœ„ì¹˜:** `src/main/java/com/simpleblog/entity/Post.java`

```java
package com.simpleblog.entity;

import jakarta.persistence.*;
import lombok.AccessLevel;
import lombok.Builder;
import lombok.Getter;
import lombok.NoArgsConstructor;
import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.LastModifiedDate;
import org.springframework.data.jpa.domain.support.AuditingEntityListener;

import java.time.LocalDateTime;

@Entity
@Table(name = "posts")
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
@EntityListeners(AuditingEntityListener.class)
public class Post {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false, length = 200)
    private String title;

    @Column(nullable = false, columnDefinition = "TEXT")
    private String content;

    @Column(nullable = false, length = 100)
    private String author;

    @CreatedDate
    @Column(nullable = false, updatable = false)
    private LocalDateTime createdAt;

    @LastModifiedDate
    @Column(nullable = false)
    private LocalDateTime updatedAt;

    @Builder
    public Post(String title, String content, String author) {
        this.title = title;
        this.content = content;
        this.author = author;
    }

    // ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œ
    public void update(String title, String content) {
        this.title = title;
        this.content = content;
    }
}
```

**PMì´ ì•Œì•„ì•¼ í•  ì–´ë…¸í…Œì´ì…˜:**
```
@Entity         â†’ JPA Entity (DB í…Œì´ë¸”ê³¼ ë§¤í•‘)
@Table          â†’ í…Œì´ë¸” ì´ë¦„ ì§€ì •
@Id             â†’ ê¸°ë³¸í‚¤ (Primary Key)
@GeneratedValue â†’ ìë™ ì¦ê°€ (AUTO_INCREMENT)
@Column         â†’ ì»¬ëŸ¼ ì„¤ì • (null í—ˆìš©, ê¸¸ì´ ë“±)
@CreatedDate    â†’ ìƒì„±ì¼ì‹œ ìë™ ì„¤ì •
@LastModifiedDate â†’ ìˆ˜ì •ì¼ì‹œ ìë™ ì—…ë°ì´íŠ¸
```

---

### 1.2 Repository ì‘ì„± (DB ì ‘ê·¼)

**íŒŒì¼ ìœ„ì¹˜:** `src/main/java/com/simpleblog/repository/PostRepository.java`

```java
package com.simpleblog.repository;

import com.simpleblog.entity.Post;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
public interface PostRepository extends JpaRepository<Post, Long> {

    // ê¸°ë³¸ CRUDëŠ” JpaRepositoryê°€ ì œê³µ:
    // - save(Post) â†’ INSERT or UPDATE
    // - findById(Long) â†’ SELECT * FROM posts WHERE id = ?
    // - findAll() â†’ SELECT * FROM posts
    // - deleteById(Long) â†’ DELETE FROM posts WHERE id = ?

    // ì»¤ìŠ¤í…€ ì¿¼ë¦¬: ìµœì‹ ìˆœ ì •ë ¬
    List<Post> findAllByOrderByCreatedAtDesc();

    // ì œëª©ìœ¼ë¡œ ê²€ìƒ‰ (LIKE ê²€ìƒ‰) - 2ì°¨ ê°œë°œ
    // List<Post> findByTitleContaining(String keyword);
}
```

**PMì´ ì•Œì•„ì•¼ í•  Spring Data JPA ë§ˆë²•:**
```
JpaRepositoryë¥¼ extends í•˜ë©´:
â†’ ê¸°ë³¸ CRUD ë©”ì„œë“œ 20ê°œ ìë™ ì œê³µ!
â†’ SQL ì‘ì„± ì•ˆ í•´ë„ ë¨

ë©”ì„œë“œ ì´ë¦„ë§Œìœ¼ë¡œ ì¿¼ë¦¬ ìë™ ìƒì„±:
findAllByOrderByCreatedAtDesc()
â†’ SELECT * FROM posts ORDER BY created_at DESC

findByTitleContaining("Java")
â†’ SELECT * FROM posts WHERE title LIKE '%Java%'
```

---

### 1.3 DTO ì‘ì„± (ìš”ì²­/ì‘ë‹µ ê°ì²´)

**ì™œ DTOê°€ í•„ìš”í•œê°€?**
```
âŒ Entityë¥¼ ì§ì ‘ ë°˜í™˜í•˜ë©´:
- ë¹„ë°€ë²ˆí˜¸ ê°™ì€ ë¯¼ê° ì •ë³´ ë…¸ì¶œ ìœ„í—˜
- ìˆœí™˜ ì°¸ì¡° ë¬¸ì œ (ì—°ê´€ ê´€ê³„ ìˆì„ ë•Œ)
- API ìŠ¤í™ ë³€ê²½ ì‹œ DB ìŠ¤í‚¤ë§ˆë„ ë³€ê²½

âœ… DTO ì‚¬ìš©:
- í•„ìš”í•œ í•„ë“œë§Œ ì„ íƒì ìœ¼ë¡œ ì „ì†¡
- API ìŠ¤í™ê³¼ DB ìŠ¤í‚¤ë§ˆ ë…ë¦½
```

**íŒŒì¼ ìœ„ì¹˜:** `src/main/java/com/simpleblog/dto/`

**PostCreateRequest.java (ê²Œì‹œê¸€ ìƒì„± ìš”ì²­):**
```java
package com.simpleblog.dto;

import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.Size;
import lombok.Getter;
import lombok.NoArgsConstructor;

@Getter
@NoArgsConstructor
public class PostCreateRequest {

    @NotBlank(message = "ì œëª©ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.")
    @Size(max = 200, message = "ì œëª©ì€ ìµœëŒ€ 200ìê¹Œì§€ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.")
    private String title;

    @NotBlank(message = "ë‚´ìš©ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.")
    private String content;

    @NotBlank(message = "ì‘ì„±ìëŠ” í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.")
    @Size(max = 100, message = "ì‘ì„±ìëŠ” ìµœëŒ€ 100ìê¹Œì§€ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.")
    private String author;
}
```

**PostUpdateRequest.java (ê²Œì‹œê¸€ ìˆ˜ì • ìš”ì²­):**
```java
package com.simpleblog.dto;

import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.Size;
import lombok.Getter;
import lombok.NoArgsConstructor;

@Getter
@NoArgsConstructor
public class PostUpdateRequest {

    @NotBlank(message = "ì œëª©ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.")
    @Size(max = 200, message = "ì œëª©ì€ ìµœëŒ€ 200ìê¹Œì§€ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.")
    private String title;

    @NotBlank(message = "ë‚´ìš©ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.")
    private String content;
}
```

**PostResponse.java (ê²Œì‹œê¸€ ì‘ë‹µ):**
```java
package com.simpleblog.dto;

import com.simpleblog.entity.Post;
import lombok.Builder;
import lombok.Getter;

import java.time.LocalDateTime;

@Getter
@Builder
public class PostResponse {

    private Long id;
    private String title;
    private String content;
    private String author;
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;

    // Entity â†’ DTO ë³€í™˜
    public static PostResponse from(Post post) {
        return PostResponse.builder()
                .id(post.getId())
                .title(post.getTitle())
                .content(post.getContent())
                .author(post.getAuthor())
                .createdAt(post.getCreatedAt())
                .updatedAt(post.getUpdatedAt())
                .build();
    }
}
```

**PostListResponse.java (ëª©ë¡ ì¡°íšŒ ì‘ë‹µ):**
```java
package com.simpleblog.dto;

import com.simpleblog.entity.Post;
import lombok.Builder;
import lombok.Getter;

import java.time.LocalDateTime;

@Getter
@Builder
public class PostListResponse {

    private Long id;
    private String title;
    private String author;
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;

    // ëª©ë¡ì€ content ì œì™¸ (ì„±ëŠ¥ ìµœì í™”)
    public static PostListResponse from(Post post) {
        return PostListResponse.builder()
                .id(post.getId())
                .title(post.getTitle())
                .author(post.getAuthor())
                .createdAt(post.getCreatedAt())
                .updatedAt(post.getUpdatedAt())
                .build();
    }
}
```

---

### 1.4 Service ì‘ì„± (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)

**íŒŒì¼ ìœ„ì¹˜:** `src/main/java/com/simpleblog/service/PostService.java`

```java
package com.simpleblog.service;

import com.simpleblog.dto.PostCreateRequest;
import com.simpleblog.dto.PostListResponse;
import com.simpleblog.dto.PostResponse;
import com.simpleblog.dto.PostUpdateRequest;
import com.simpleblog.entity.Post;
import com.simpleblog.repository.PostRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;
import java.util.stream.Collectors;

@Service
@RequiredArgsConstructor
@Transactional(readOnly = true)
public class PostService {

    private final PostRepository postRepository;

    /**
     * ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ (ìµœì‹ ìˆœ)
     */
    public List<PostListResponse> getAllPosts() {
        return postRepository.findAllByOrderByCreatedAtDesc()
                .stream()
                .map(PostListResponse::from)
                .collect(Collectors.toList());
    }

    /**
     * ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ
     */
    public PostResponse getPost(Long id) {
        Post post = postRepository.findById(id)
                .orElseThrow(() -> new IllegalArgumentException(
                        "ê²Œì‹œê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ID: " + id + ")"
                ));
        return PostResponse.from(post);
    }

    /**
     * ê²Œì‹œê¸€ ìƒì„±
     */
    @Transactional
    public PostResponse createPost(PostCreateRequest request) {
        Post post = Post.builder()
                .title(request.getTitle())
                .content(request.getContent())
                .author(request.getAuthor())
                .build();

        Post savedPost = postRepository.save(post);
        return PostResponse.from(savedPost);
    }

    /**
     * ê²Œì‹œê¸€ ìˆ˜ì •
     */
    @Transactional
    public PostResponse updatePost(Long id, PostUpdateRequest request) {
        Post post = postRepository.findById(id)
                .orElseThrow(() -> new IllegalArgumentException(
                        "ê²Œì‹œê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ID: " + id + ")"
                ));

        post.update(request.getTitle(), request.getContent());
        // @Transactionalì— ì˜í•´ ìë™ìœ¼ë¡œ UPDATE ì¿¼ë¦¬ ì‹¤í–‰ (Dirty Checking)

        return PostResponse.from(post);
    }

    /**
     * ê²Œì‹œê¸€ ì‚­ì œ
     */
    @Transactional
    public void deletePost(Long id) {
        if (!postRepository.existsById(id)) {
            throw new IllegalArgumentException(
                    "ê²Œì‹œê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ID: " + id + ")"
            );
        }
        postRepository.deleteById(id);
    }
}
```

**PMì´ ì•Œì•„ì•¼ í•  Service ê³„ì¸µ í¬ì¸íŠ¸:**
```
@Transactional:
- ë©”ì„œë“œ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ ì‹œ ìë™ ë¡¤ë°±
- ì—¬ëŸ¬ DB ì‘ì—…ì„ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ìŒ

@Transactional(readOnly = true):
- í´ë˜ìŠ¤ ë ˆë²¨: ê¸°ë³¸ì€ ì½ê¸° ì „ìš©
- ë©”ì„œë“œ ë ˆë²¨: ì“°ê¸°ê°€ í•„ìš”í•œ ê³³ë§Œ @Transactional

Dirty Checking (ë³€ê²½ ê°ì§€):
- post.update() í˜¸ì¶œí•˜ë©´
- @Transactionalì´ ìë™ìœ¼ë¡œ UPDATE ì¿¼ë¦¬ ì‹¤í–‰
- ë³„ë„ë¡œ save() ì•ˆ í•´ë„ ë¨!
```

---

### 1.5 Controller ì‘ì„± (REST API)

**íŒŒì¼ ìœ„ì¹˜:** `src/main/java/com/simpleblog/controller/PostController.java`

```java
package com.simpleblog.controller;

import com.simpleblog.dto.PostCreateRequest;
import com.simpleblog.dto.PostListResponse;
import com.simpleblog.dto.PostResponse;
import com.simpleblog.dto.PostUpdateRequest;
import com.simpleblog.service.PostService;
import jakarta.validation.Valid;
import lombok.RequiredArgsConstructor;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/posts")
@RequiredArgsConstructor
public class PostController {

    private final PostService postService;

    /**
     * ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ
     * GET /api/posts
     */
    @GetMapping
    public ResponseEntity<List<PostListResponse>> getAllPosts() {
        List<PostListResponse> posts = postService.getAllPosts();
        return ResponseEntity.ok(posts);
    }

    /**
     * ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ
     * GET /api/posts/{id}
     */
    @GetMapping("/{id}")
    public ResponseEntity<PostResponse> getPost(@PathVariable Long id) {
        PostResponse post = postService.getPost(id);
        return ResponseEntity.ok(post);
    }

    /**
     * ê²Œì‹œê¸€ ìƒì„±
     * POST /api/posts
     */
    @PostMapping
    public ResponseEntity<PostResponse> createPost(
            @Valid @RequestBody PostCreateRequest request
    ) {
        PostResponse post = postService.createPost(request);
        return ResponseEntity.status(HttpStatus.CREATED).body(post);
    }

    /**
     * ê²Œì‹œê¸€ ìˆ˜ì •
     * PUT /api/posts/{id}
     */
    @PutMapping("/{id}")
    public ResponseEntity<PostResponse> updatePost(
            @PathVariable Long id,
            @Valid @RequestBody PostUpdateRequest request
    ) {
        PostResponse post = postService.updatePost(id, request);
        return ResponseEntity.ok(post);
    }

    /**
     * ê²Œì‹œê¸€ ì‚­ì œ
     * DELETE /api/posts/{id}
     */
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> deletePost(@PathVariable Long id) {
        postService.deletePost(id);
        return ResponseEntity.noContent().build();
    }
}
```

**PMì´ ì•Œì•„ì•¼ í•  Controller ì–´ë…¸í…Œì´ì…˜:**
```
@RestController     â†’ REST API ì»¨íŠ¸ë¡¤ëŸ¬
@RequestMapping     â†’ ê¸°ë³¸ URL (/api/posts)
@GetMapping         â†’ GET ìš”ì²­ (ì¡°íšŒ)
@PostMapping        â†’ POST ìš”ì²­ (ìƒì„±)
@PutMapping         â†’ PUT ìš”ì²­ (ìˆ˜ì •)
@DeleteMapping      â†’ DELETE ìš”ì²­ (ì‚­ì œ)
@PathVariable       â†’ URL ê²½ë¡œì—ì„œ ê°’ ì¶”ì¶œ (/api/posts/1 â†’ id=1)
@RequestBody        â†’ JSON ìš”ì²­ bodyë¥¼ DTOë¡œ ë³€í™˜
@Valid              â†’ ìœ íš¨ì„± ê²€ì¦ ì‹¤í–‰ (@NotBlank ë“±)
```

---

### 1.6 ì˜ˆì™¸ ì²˜ë¦¬ (GlobalExceptionHandler)

**íŒŒì¼ ìœ„ì¹˜:** `src/main/java/com/simpleblog/exception/GlobalExceptionHandler.java`

```java
package com.simpleblog.exception;

import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.validation.FieldError;
import org.springframework.web.bind.MethodArgumentNotValidException;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.RestControllerAdvice;

import java.time.LocalDateTime;
import java.util.HashMap;
import java.util.Map;

@RestControllerAdvice
public class GlobalExceptionHandler {

    /**
     * ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨ (400 Bad Request)
     */
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<ErrorResponse> handleValidationException(
            MethodArgumentNotValidException ex
    ) {
        Map<String, String> errors = new HashMap<>();
        ex.getBindingResult().getAllErrors().forEach(error -> {
            String fieldName = ((FieldError) error).getField();
            String errorMessage = error.getDefaultMessage();
            errors.put(fieldName, errorMessage);
        });

        ErrorResponse response = ErrorResponse.builder()
                .error("VALIDATION_ERROR")
                .message("ì…ë ¥ê°’ ê²€ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
                .details(errors)
                .timestamp(LocalDateTime.now())
                .build();

        return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(response);
    }

    /**
     * ë¦¬ì†ŒìŠ¤ ì—†ìŒ (404 Not Found)
     */
    @ExceptionHandler(IllegalArgumentException.class)
    public ResponseEntity<ErrorResponse> handleNotFoundException(
            IllegalArgumentException ex
    ) {
        ErrorResponse response = ErrorResponse.builder()
                .error("RESOURCE_NOT_FOUND")
                .message(ex.getMessage())
                .timestamp(LocalDateTime.now())
                .build();

        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(response);
    }

    /**
     * ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ (500 Internal Server Error)
     */
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> handleException(Exception ex) {
        ErrorResponse response = ErrorResponse.builder()
                .error("INTERNAL_SERVER_ERROR")
                .message("ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                .timestamp(LocalDateTime.now())
                .build();

        return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(response);
    }
}
```

**ErrorResponse.java:**
```java
package com.simpleblog.exception;

import lombok.Builder;
import lombok.Getter;

import java.time.LocalDateTime;
import java.util.Map;

@Getter
@Builder
public class ErrorResponse {
    private String error;
    private String message;
    private Map<String, String> details;
    private LocalDateTime timestamp;
}
```

---

## 2. ì‹¤í–‰ ë° í…ŒìŠ¤íŠ¸

### 2.1 Application ì‹¤í–‰

**SimpleblogApplication.javaì— JPA Auditing í™œì„±í™” ì¶”ê°€:**
```java
package com.simpleblog;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;

@SpringBootApplication
@EnableJpaAuditing  // @CreatedDate, @LastModifiedDate í™œì„±í™”
public class SimpleblogApplication {

    public static void main(String[] args) {
        SpringApplication.run(SimpleblogApplication.class, args);
    }

}
```

### 2.2 Postman í…ŒìŠ¤íŠ¸

**1) ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ:**
```
GET http://localhost:8080/api/posts
```

**2) ê²Œì‹œê¸€ ìƒì„±:**
```
POST http://localhost:8080/api/posts
Content-Type: application/json

{
  "title": "Postman í…ŒìŠ¤íŠ¸",
  "content": "Postmanìœ¼ë¡œ ì‘ì„±í•œ ê²Œì‹œê¸€ì…ë‹ˆë‹¤.",
  "author": "í…ŒìŠ¤í„°"
}
```

**3) ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ:**
```
GET http://localhost:8080/api/posts/1
```

**4) ê²Œì‹œê¸€ ìˆ˜ì •:**
```
PUT http://localhost:8080/api/posts/1
Content-Type: application/json

{
  "title": "ìˆ˜ì •ëœ ì œëª©",
  "content": "ìˆ˜ì •ëœ ë‚´ìš©ì…ë‹ˆë‹¤."
}
```

**5) ê²Œì‹œê¸€ ì‚­ì œ:**
```
DELETE http://localhost:8080/api/posts/1
```

---

## 3. ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ì‘ì„±ì | ë³€ê²½ ë‚´ìš© |
|------|------|--------|----------|
| 1.0 | 2025-10-17 | ê°œë°œíŒ€ | ìµœì´ˆ ì‘ì„± |

---

**ë‹¤ìŒ ë‹¨ê³„:** [7ë‹¨ê³„ í…ŒìŠ¤íŠ¸](../step7-testing/) ğŸš€
